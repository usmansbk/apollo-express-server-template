type Query {
  permissions(page: ListPage, filter: PermissionFilter): PermissionList! @auth
}

type Mutation {
  createPermissions(inputs: [CreatePermissionInput!]!): PermissionFormResponse!
    @auth
  updatePermission(input: UpdatePermissionInput!): PermissionFormResponse! @auth
  deletePermissions(ids: [ID!]!, reason: String): DeleteResponse! @auth
  detachPermissionFromAllRoles(permissionId: ID!): PermissionPayload! @auth
}

type Permission {
  id: ID!
  name: String!
  action: PermissionAction!
  resource: PermissionResource!
  description: String
  roles(page: ListPage, filter: RoleFilter): RoleList!
  createdAt: DateTime!
  updatedAt: DateTime
}

type PermissionPayload implements Response {
  code: ID!
  success: Boolean!
  message: String!
  permission: Permission
}

type PermissionListPayload implements Response {
  code: ID!
  success: Boolean!
  message: String!
  permissions: [Permission]
}

type PermissionFormResponse implements Response & FormErrors {
  code: ID!
  success: Boolean!
  message: String!
  permissions: [Permission]
  errors: [FieldError!]
}

input CreatePermissionInput {
  name: String!
  action: PermissionAction!
  resource: PermissionResource!
  description: String
}

input UpdatePermissionInput {
  id: ID!
  name: String
  action: PermissionAction
  resource: PermissionResource
  description: String
}

enum PermissionResource {
  users
  roles
  permissions
  all
}

enum PermissionAction {
  all
  create
  read
  update
  delete
  list
}

# Pagination

type PermissionList implements List {
  items: [Permission]!
  totalCount: Int!
  pageInfo: PageInfo!
}

# Filter

input PermissionFilter {
  id: IDFieldFilter
  name: StringFieldFilter
  action: StringFieldFilter
  resource: StringFieldFilter
  createdAt: DateTimeFieldFilter
  updatedAt: DateTimeFieldFilter
}
